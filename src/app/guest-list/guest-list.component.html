<div class="header" *ngIf="showCheckbox">
    <div class="header-prefix">
        <mat-checkbox [(ngModel)]="totalChecked" (click)="$event.stopPropagation()"></mat-checkbox>
        <p>{{totalCheckedNumber}}팀 선택</p>
        <mat-icon matRipple (click)="showCheckbox=false">clear</mat-icon>

    </div>
    <div class="header-suffix" [class.disabled]="totalCheckedNumber === 0">
        <mat-icon matRipple [matMenuTriggerFor]="mailMenu">mail_outline</mat-icon>
        <mat-icon matRipple (click)="deleteGuests()">delete</mat-icon>
    </div>
</div>

<mat-menu #mailMenu="matMenu">
    <button mat-menu-item>입금요청 문자 전송</button>
    <button mat-menu-item>예약완료 문자 전송</button>
    <button mat-menu-item>주차등록 문자 전송</button>
    <button mat-menu-item>문자 전송</button>
</mat-menu>

<div *ngIf="readyList.length>0">
    <p class="sub-title" *ngIf="readyList.length > 0">예약 대기 상태</p>
    <div class="list">
        <div class="list-item" *ngFor="let user of readyList" mat-ripple
             (click)="showCheckbox? user.checked = !user.checked : showDetailUser(user)"
             (touchstart)="touchStart(user)" (touchend)="touchEnd()">
            <div class="checkbox" *ngIf="showCheckbox">
                <mat-checkbox [(ngModel)]="user.checked" (click)="$event.stopPropagation()"></mat-checkbox>
            </div>
            <div class="prefix">
                <p>{{type(user)}}</p>
            </div>
            <div class="content">
                <p class="content-title">{{user.name}} ({{user.person + user.kids}}명)</p>
                <p class="content-desc">{{user.customerMemo}}</p>
            </div>
            <div class="suffix" matRipple (click)="$event.stopPropagation()" [matMenuTriggerFor]="statusMenu" [matMenuTriggerData]="{user: user}">
                <p>{{status(user)}}</p>
            </div>
        </div>
    </div>
</div>

<div *ngIf="flatTableList.length>0">
    <p class="sub-title" *ngIf="flatTableList.length > 0">평상 예약</p>
    <div class="list">
        <div class="list-item" *ngFor="let user of flatTableList" mat-ripple
             (click)="showCheckbox? user.checked = !user.checked : showDetailUser(user)"
             (touchstart)="touchStart(user)" (touchend)="touchEnd()">
            <div class="checkbox" *ngIf="showCheckbox">
                <mat-checkbox [(ngModel)]="user.checked" (click)="$event.stopPropagation()"></mat-checkbox>
            </div>
            <div class="prefix">
                <p *ngIf="user.flatTable>0">평상{{user.flatTable}}</p>
                <p *ngIf="user.dechTable>0">데크{{user.dechTable}}</p>
            </div>
            <div class="content">
                <p class="content-title">{{user.name}} ({{user.person + user.kids}}명)</p>
                <p class="content-desc">{{user.customerMemo}}</p>
            </div>
            <div class="suffix" matRipple (click)="$event.stopPropagation()" [matMenuTriggerFor]="statusMenu" [matMenuTriggerData]="{user: user}">
                <p>{{status(user)}}</p>
            </div>
        </div>
    </div>
</div>


<mat-menu #statusMenu="matMenu">
    <ng-template matMenuContent let-user="user">
        <button mat-menu-item *ngIf="user.status !=='bookingComplete'" (click)="setStatus(user, 'bookingComplete')">예약</button>
        <button mat-menu-item *ngIf="user.status !=='cancel'" (click)="setStatus(user, 'cancel')">취소</button>
        <button mat-menu-item *ngIf="user.status !=='ready'" (click)="setStatus(user, 'ready')">대기</button>
        <button mat-menu-item *ngIf="user.status !=='paymentReady'" (click)="setStatus(user, 'paymentReady')">입금전</button>
    </ng-template>

</mat-menu>