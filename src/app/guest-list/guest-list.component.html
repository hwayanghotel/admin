<div class="header search" *ngIf="isSearch">
    <div class="header-prefix">
        <mat-icon mat-icon matRipple (click)="onBackButton()">keyboard_arrow_left</mat-icon>
    </div>
    <div class="header-content">
        <input #Input [(ngModel)]="searchInput" (blur)="focusInput()">
    </div>
    <div class="header-suffix">
        <mat-icon matRipple *ngIf="isSearch" (click)="searchInput=undefined">clear</mat-icon>
        <mat-icon matRipple>more_vert</mat-icon>
    </div>
</div>
<div class="search-header-container" *ngIf="isSearch"></div>

<div class="header" *ngIf="showCheckbox">
    <div class="header-prefix">
        <mat-checkbox [(ngModel)]="totalChecked" (click)="$event.stopPropagation()"></mat-checkbox>
        <p>{{totalCheckedNumber}}팀 선택</p>
        <mat-icon matRipple (click)="showCheckbox=false">clear</mat-icon>
    </div>
    <div class="header-suffix" [class.disabled]="totalCheckedNumber === 0">
        <mat-icon matRipple [matMenuTriggerFor]="mailMenu">mail_outline</mat-icon>
        <mat-icon matRipple (click)="deleteGuests()">delete</mat-icon>
    </div>
</div>

<mat-menu #mailMenu="matMenu">
    <button mat-menu-item>입금요청 문자 전송</button>
    <button mat-menu-item>예약완료 문자 전송</button>
    <button mat-menu-item>주차등록 문자 전송</button>
    <button mat-menu-item>문자 전송</button>
</mat-menu>

<div class="sub-title" matRipple *ngIf="readyList.length" (click)="expandStatus.readyList = !expandStatus.readyList">
    <p>대기 상태</p>
    <mat-icon *ngIf="expandStatus.readyList">expand_more</mat-icon>
    <mat-icon *ngIf="!expandStatus.readyList">expand_less</mat-icon>
</div>

<div class="list" *ngIf="readyList.length && expandStatus.readyList">
    <div class="list-item" *ngFor="let user of readyList" mat-ripple
         (click)="showCheckbox? user.checked = !user.checked : showDetailUser(user)"
         (touchstart)="touchStart(user)" (touchend)="touchEnd()">
        <div class="checkbox" *ngIf="showCheckbox">
            <mat-checkbox [(ngModel)]="user.checked" (click)="$event.stopPropagation()"></mat-checkbox>
        </div>
        <div class="prefix" matRipple (click)="$event.stopPropagation()" [matMenuTriggerFor]="statusMenu" [matMenuTriggerData]="{user: user}">
            <p *ngIf="isSearch">{{user.date.format("MM/DD")}}</p>
            <p *ngIf="user.flatTable">평상{{user.flatTable}}</p>
            <p *ngIf="user.dechTable">데크{{user.dechTable}}</p>
            <p *ngIf="!user.flatTable && !user.dechTable">{{user.date.format("HH:mm")}}</p>
        </div>
        <div class="content">
            <p class="content-title ready">{{user.name}}
                ({{user.person + user.kids}}명)</p>
            <div class="content-desc">
                <p>
                    <span *ngIf="user.neungiBaeksuk">능이{{user.neungiBaeksuk}}, </span>
                    <span *ngIf="user.baeksuk">한방{{user.baeksuk}}, </span>
                    <span *ngIf="user.mushroomStew">버섯{{user.mushroomStew}}, </span>
                    <span *ngIf="user.mushroomStewForTwoPeople">버섯小{{user.mushroomStewForTwoPeople}}</span>
                </p>
                <p>{{user.customerMemo}}</p>
            </div>
        </div>
    </div>
</div>

<div class="sub-title" matRipple *ngIf="flatTableList.length" (click)="expandStatus.flatTableList = !expandStatus.flatTableList">
    <p>평상 예약</p>
    <mat-icon *ngIf="expandStatus.flatTableList">expand_more</mat-icon>
    <mat-icon *ngIf="!expandStatus.flatTableList">expand_less</mat-icon>
</div>

<div class="list" *ngIf="flatTableList.length && expandStatus.flatTableList">
    <div class="list-item" *ngFor="let user of flatTableList" mat-ripple
         (click)="showCheckbox? user.checked = !user.checked : showDetailUser(user)"
         (touchstart)="touchStart(user)" (touchend)="touchEnd()">
        <div class="checkbox" *ngIf="showCheckbox">
            <mat-checkbox [(ngModel)]="user.checked" (click)="$event.stopPropagation()"></mat-checkbox>
        </div>
        <div class="prefix" matRipple (click)="$event.stopPropagation()" [matMenuTriggerFor]="statusMenu" [matMenuTriggerData]="{user: user}">
            <p *ngIf="isSearch">{{user.date.format("MM/DD")}}</p>
            <p *ngIf="user.flatTable">평상{{user.flatTable}}</p>
            <p *ngIf="user.dechTable">데크{{user.dechTable}}</p>
        </div>
        <div class="content">
            <p class="content-title flat-table">{{user.name}}
                ({{user.person + user.kids}}명)</p>
            <div class="content-desc">
                <p>
                    <span *ngIf="user.neungiBaeksuk">능이{{user.neungiBaeksuk}}, </span>
                    <span *ngIf="user.baeksuk">한방{{user.baeksuk}}, </span>
                    <span *ngIf="user.mushroomStew">버섯{{user.mushroomStew}}, </span>
                    <span *ngIf="user.mushroomStewForTwoPeople">버섯小{{user.mushroomStewForTwoPeople}}</span>
                </p>
                <p>{{user.customerMemo}}</p>
            </div>
        </div>
    </div>
</div>

<div class="sub-title" matRipple *ngIf="foodList.length" (click)="expandStatus.foodList = !expandStatus.foodList">
    <p>식사 예약</p>
    <mat-icon *ngIf="expandStatus.foodList">expand_more</mat-icon>
    <mat-icon *ngIf="!expandStatus.foodList">expand_less</mat-icon>
</div>

<div class="list" *ngIf="foodList.length && expandStatus.foodList">
    <div class="list-item" *ngFor="let user of foodList" mat-ripple
         (click)="showCheckbox? user.checked = !user.checked : showDetailUser(user)"
         (touchstart)="touchStart(user)" (touchend)="touchEnd()">
        <div class="checkbox" *ngIf="showCheckbox">
            <mat-checkbox [(ngModel)]="user.checked" (click)="$event.stopPropagation()"></mat-checkbox>
        </div>
        <div class="prefix" matRipple (click)="$event.stopPropagation()" [matMenuTriggerFor]="statusMenu" [matMenuTriggerData]="{user: user}">
            <p *ngIf="isSearch">{{user.date.format("MM/DD")}}</p>
            <p>{{user.date.format("HH:mm")}}</p>
        </div>
        <div class="content">
            <p class="content-title food">{{user.name}}
                ({{user.person + user.kids}}명)</p>
            <div class="content-desc">
                <p>
                    <span *ngIf="user.neungiBaeksuk">능이{{user.neungiBaeksuk}}, </span>
                    <span *ngIf="user.baeksuk">한방{{user.baeksuk}}, </span>
                    <span *ngIf="user.mushroomStew">버섯{{user.mushroomStew}}, </span>
                    <span *ngIf="user.mushroomStewForTwoPeople">버섯小{{user.mushroomStewForTwoPeople}}</span>
                </p>
                <p>{{user.customerMemo}}</p>
            </div>
        </div>
    </div>
</div>
<div class="sub-title" matRipple *ngIf="cancelList.length" (click)="expandStatus.cancelList = !expandStatus.cancelList">
    <p>취소 고객</p>
    <mat-icon *ngIf="expandStatus.cancelList">expand_more</mat-icon>
    <mat-icon *ngIf="!expandStatus.cancelList">expand_less</mat-icon>
</div>

<div class="list" *ngIf="cancelList.length && expandStatus.cancelList">
    <div class="list-item" *ngFor="let user of cancelList" mat-ripple
         (click)="showCheckbox? user.checked = !user.checked : showDetailUser(user)"
         (touchstart)="touchStart(user)" (touchend)="touchEnd()">
        <div class="checkbox" *ngIf="showCheckbox">
            <mat-checkbox [(ngModel)]="user.checked" (click)="$event.stopPropagation()"></mat-checkbox>
        </div>
        <div class="prefix" matRipple (click)="$event.stopPropagation()" [matMenuTriggerFor]="statusMenu" [matMenuTriggerData]="{user: user}">
            <p *ngIf="isSearch">{{user.date.format("MM/DD")}}</p>
            <p *ngIf="user.flatTable">평상{{user.flatTable}}</p>
            <p *ngIf="user.dechTable">데크{{user.dechTable}}</p>
            <p *ngIf="!user.flatTable && !user.dechTable">{{user.date.format("HH:mm")}}</p>
        </div>
        <div class="content">
            <p class="content-title cancel">{{user.name}}
                ({{user.person + user.kids}}명)</p>
            <div class="content-desc">
                <p>
                    <span *ngIf="user.neungiBaeksuk">능이{{user.neungiBaeksuk}}, </span>
                    <span *ngIf="user.baeksuk">한방{{user.baeksuk}}, </span>
                    <span *ngIf="user.mushroomStew">버섯{{user.mushroomStew}}, </span>
                    <span *ngIf="user.mushroomStewForTwoPeople">버섯小{{user.mushroomStewForTwoPeople}}</span>
                </p>
                <p>{{user.customerMemo}}</p>
            </div>
        </div>
    </div>
</div>

<mat-menu #statusMenu="matMenu">
    <ng-template matMenuContent let-user="user">
        <button mat-menu-item *ngIf="user.status !=='bookingComplete'" (click)="setStatus(user, 'bookingComplete')">예약</button>
        <button mat-menu-item *ngIf="user.status !=='cancel'" (click)="setStatus(user, 'cancel')">취소</button>
        <button mat-menu-item *ngIf="user.status !=='ready'" (click)="setStatus(user, 'ready')">대기</button>
        <button mat-menu-item *ngIf="user.status !=='paymentReady'" (click)="setStatus(user, 'paymentReady')">입금전</button>
    </ng-template>
</mat-menu>